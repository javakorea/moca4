<!DOCTYPE html>
<html lang="ko">
<head meta_width="1400px" meta_height="700px">
<script>
moca.EFC_BOAD_POP.editor;
moca.EFC_BOAD_POP._boardIdx;
moca.EFC_BOAD_POP._boardPIdx;
moca.EFC_BOAD_POP._boardType;
moca.EFC_BOAD_POP._boardTitle;
moca.EFC_BOAD_POP.___ready = function(args){
	moca.hide(moca.EFC_BOAD_POP.getObj('grd_file_btn_delrow'));
	moca.hide(moca.EFC_BOAD_POP.getObj('grd_reply_file_btn_delrow'));
	moca.hide($(moca.EFC_BOAD_POP.getObj('grd_file_btn_fold')).siblings());
	moca.hide($(moca.EFC_BOAD_POP.getObj('grd_reply_file_btn_fold')).siblings());
	moca.hide($(moca.EFC_BOAD_POP.getObj('grd_file')).find('.moca_grid_list'));
	moca.hide($(moca.EFC_BOAD_POP.getObj('grd_reply_file')).find('.moca_grid_list'));
	if(args != null){
		moca.EFC_BOAD_POP.args = args;
		moca.EFC_BOAD_POP._boardIdx = moca.EFC_BOAD_POP.args.parent.data.BOAD_IDX;
		moca.EFC_BOAD_POP._boardPIdx = moca.EFC_BOAD_POP.args.parent.data.BOAD_PIDX;
		moca.EFC_BOAD_POP._boardType = moca.EFC_BOAD_POP.args.parent.data.BOAD_TYPE;
		moca.EFC_BOAD_POP._boardTitle = moca.EFC_BOAD_POP.args.parent.data.BOAD_TITLE;
	}
	CKEDITOR.replace( 'editor',{uiColor:'#fff9da',on:{
        'instanceReady':function(ev){
            moca.EFC_BOAD_POP.editor = ev.editor;
            moca.EFC_BOAD_POP._boardIdx = moca.EFC_BOAD_POP.args.parent.data.BOAD_IDX;
            if(moca.EFC_BOAD_POP._boardIdx != null){
                moca.EFC_BOAD_POP.editor.setReadOnly(true);
            }
            $('#contents').show();
            moca.EFC_BOAD_POP.fn_search();
            
    }}} );
	CKEDITOR.replace( 'reply_editor',{uiColor:'#deecea',on:{
        'instanceReady':function(ev){

    }}} );
	
	/*
    CKEDITOR.on('instanceReady', function(ev) {

    });
    */
};

moca.EFC_BOAD_POP.fn_search = function(_grd,_idx,tdObj,_thisObj){
	if(moca.EFC_BOAD_POP._boardIdx != null){
		moca.hide($(moca.EFC_BOAD_POP.getObj("cke_editor")).find('#cke_1_top'));
		//답변일경우
		if(moca.EFC_BOAD_POP._boardPIdx != "" && moca.EFC_BOAD_POP._boardIdx != moca.EFC_BOAD_POP._boardPIdx){
			//showhide처리
			moca.hide($(moca.EFC_BOAD_POP.getObj("cke_editor")).find("[id$='_top']"));
			moca.hide($(moca.EFC_BOAD_POP.getObj("cke_reply_editor")).find("[id$='_top']"));
			moca.show(moca.EFC_BOAD_POP.getObj("reply_area"));
			moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply"));
			moca.hide(moca.EFC_BOAD_POP.getObj("btn_update"));
			moca.hide(moca.EFC_BOAD_POP.getObj("btn_del"));
			moca.hide(moca.EFC_BOAD_POP.getObj("btn_del_admin"));
			moca.show(moca.EFC_BOAD_POP.getObj("btn_reply_del_admin"));
			
			moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_save"));
			moca.hide(moca.EFC_BOAD_POP.getObj('grd_reply_file_btn_fold'));
			moca.EFC_BOAD_POP.exe({
				url : moca._domain+moca._contextRoot+"/EFC_BOAD/selectBoardInfo.do",
				loadingbar:true,
				data : {
					"header" : moca.header,
					"body" : {
						"BOAD_IDX":moca.EFC_BOAD_POP._boardPIdx
						}
				},			
				callback : function(response){
						if(response.selectBoardInfo != null ){
						var data = response.selectBoardInfo;
						CKEDITOR.instances.editor.setData(data.BOAD_CONT);
						moca.setValue(moca.EFC_BOAD_POP.getObj("wtitle"),data.BOAD_TITLE);
						moca.setValue(moca.EFC_BOAD_POP.getObj("wdate"),data.BOAD_DATE);
						moca.setValue(moca.EFC_BOAD_POP.getObj("wid"),data.BOAD_WRITER);
					    moca.setValue(moca.EFC_BOAD_POP.getObj("widx"),data.BOAD_IDX);
					    moca.hide(moca.EFC_BOAD_POP.getObj("btn_save"));
					    moca.hide(moca.EFC_BOAD_POP.getObj("btn_add"));
					    moca.hide(moca.EFC_BOAD_POP.getObj('grd_file_btn_fold'));
					    if(moca.getValue(moca.EFC_BOAD_POP.getObj("wid")) != moca.getSs("USER_ID") && moca.getSs("authorCode") != "ROLE_SUPER_ADMIN"){
					    	moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_update"));
					    	moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_del"));
					    }
					    
					    //moca.EFC_BOAD_POP.fn_searchfile();
					    moca.EFC_BOAD_POP.drawGrid('grd_file',moca.getResList(response,"selectBoardFileList"));
					    
					    moca.EFC_BOAD_POP.fn_reply_search();
					}else{
						moca.error(response.error);
					}
				}
			});
		}else{
			moca.EFC_BOAD_POP.exe({
				url : moca._domain+moca._contextRoot+"/EFC_BOAD/selectBoardInfo.do",
				loadingbar:true,
				data : {
					"header" : moca.header,
					"body" : {
						"BOAD_IDX":moca.EFC_BOAD_POP._boardIdx
						}
				},			
				callback : function(response){
						if(response.selectBoardInfo != null ){
						var data = response.selectBoardInfo;
						CKEDITOR.instances.editor.setData(data.BOAD_CONT);
						moca.hide($(moca.EFC_BOAD_POP.getObj("cke_editor")).find("[id$='_top']"));
						moca.setValue(moca.EFC_BOAD_POP.getObj("wtitle"),data.BOAD_TITLE);
						moca.setValue(moca.EFC_BOAD_POP.getObj("wdate"),data.BOAD_DATE);
						moca.setValue(moca.EFC_BOAD_POP.getObj("wid"),data.BOAD_WRITER);
					    moca.setValue(moca.EFC_BOAD_POP.getObj("widx"),data.BOAD_IDX);
					    moca.hide(moca.EFC_BOAD_POP.getObj("btn_save"));
					    moca.hide(moca.EFC_BOAD_POP.getObj("btn_add"));
					    moca.hide(moca.EFC_BOAD_POP.getObj('grd_file_btn_fold'));
					    if(moca.getValue(moca.EFC_BOAD_POP.getObj("wid")) != moca.getSs("USER_ID") && moca.getSs("authorCode") != "ROLE_SUPER_ADMIN"){
					    	moca.hide(moca.EFC_BOAD_POP.getObj("btn_update"));
					    	moca.hide(moca.EFC_BOAD_POP.getObj("btn_del"));
					    }
					    //moca.EFC_BOAD_POP.fn_searchfile();
					    moca.EFC_BOAD_POP.drawGrid('grd_file',moca.getResList(response,"selectBoardFileList"));
					}else{
						moca.error(response.error);
					}
				}
			});
		}
	}else{
		moca.setValue(moca.EFC_BOAD_POP.getObj("wid"),moca.getSs("USER_ID"));
		moca.setValue(moca.EFC_BOAD_POP.getObj("wdate"),dateLib.getToday());
		moca.setValue(moca.EFC_BOAD_POP.getObj("widx"),"등록후채번됨");
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_update"));
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_del"));
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply"));
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_del_admin"));
		moca.setReadOnly(moca.EFC_BOAD_POP.getObj("wtitle"),false);
		CKEDITOR.replace( 'editor',{uiColor:'#fff9da',on:{
			'instanceReady':function(evt){
				CKEDITOR.instances.editor.focus();
		}}}	);
	}
	if(moca.getSs("authorCode") != "ROLE_SUPER_ADMIN"){
    	moca.hide(moca.EFC_BOAD_POP.getObj("btn_del_admin"));
    	moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_del_admin"));
    }
};

moca.EFC_BOAD_POP.fn_update = function(_thisObj){
	moca.hide(moca.EFC_BOAD_POP.getObj("btn_del_admin"));
	moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_del_admin"));
	if(_thisObj.id != 'btn_reply_update'){ //수정버튼
		$(moca.EFC_BOAD_POP.getObj("cke_editor")).find("[id$='_top']").show();
		moca.setReadOnly(moca.EFC_BOAD_POP.getObj("wtitle"),false);
		moca.setValue(moca.EFC_BOAD_POP.getObj("wid"),moca.getSs("USER_ID"));
		moca.EFC_BOAD_POP.editor.setReadOnly(false);
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_update"));
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_del"));
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply"));
		moca.show(moca.EFC_BOAD_POP.getObj("btn_save"));
		moca.show(moca.EFC_BOAD_POP.getObj("btn_add"));
		moca.show(moca.EFC_BOAD_POP.getObj('grd_file_btn_fold'));
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_del_admin"));
	}else{ //답변수정
		moca.setReadOnly(moca.EFC_BOAD_POP.getObj("wreplytitle"),false);
		$(moca.EFC_BOAD_POP.getObj("cke_reply_editor")).find("[id$='_top']").show();
		moca.setValue(moca.EFC_BOAD_POP.getObj("wreplyid"),moca.getSs("USER_ID"));
		moca.EFC_BOAD_POP.editor.setReadOnly(false);
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_update"));
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_del"));
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_del_admin"));
		
		moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply"));
		moca.show(moca.EFC_BOAD_POP.getObj("btn_reply_save"));
		moca.show(moca.EFC_BOAD_POP.getObj("btn_reply_add"));
		moca.show(moca.EFC_BOAD_POP.getObj('grd_reply_file_btn_fold'));
	}
}
moca.EFC_BOAD_POP.fn_save = function(_thisObj){
	if(_thisObj.id == 'btn_save'){
		moca.confirm('저장하시겠습니까?',function(result){
	        if(result == 'Y'){
	            for(var i=0; i<grd_file.list.length;i++){
	            	if(grd_file.list[i]._system.status != "D"){
	            		grd_file.list[i]._system.status = "C";
	            	}
	            };
	            
	            if(moca.EFC_BOAD_POP._boardIdx == null){
	                //게시물등록
	                moca.EFC_BOAD_POP.exe({
	                    url : moca._domain+moca._contextRoot+"/EFC_BOAD/insertBoard.do",
	                    loadingbar:true,
	                    data : {
	                        "header" : moca.header,
	                        "body" : {
	                        	"BOAD_DELYN":'N',
	                        	"BOAD_TYPE":moca.EFC_BOAD_POP._boardType,
	                            "BOAD_TITLE":moca.getValue(moca.EFC_BOAD_POP.getObj("wtitle")),
	                            "BOAD_CONT":CKEDITOR.instances.editor.getData(),
	                            "BOAD_WRITER":moca.getValue(moca.EFC_BOAD_POP.getObj("wid")),
	                            "fileList":moca.EFC_BOAD_POP.getFilteredList("grd_file","status","C")
	                            }
	                    },          
	                    callback : function(response){
	                        if(response.cnt > 0){
	                            moca.alert('성공적으로 저장하였습니다.');
	                            moca.popClose(moca.EFC_BOAD_POP.pageId);
	                            if(moca.EFC_BOAD_POP._boardType == 'ERP'){
	                            	moca.EFC_BOAD.fn_search();
	                            }else{
	                            	moca.EFC_BOAD_WS.fn_search();
	                            }
	                        }
	                    }
	                });
	            }else{
            		//게시글수정
            		
            		 moca.EFC_BOAD_POP.exe({
                         url : moca._domain+moca._contextRoot+"/EFC_BOAD/updateBoard.do",
                         loadingbar:true,
                         data : {
                             "header" : moca.header,
                             "body" : {
                            	 "BOAD_TYPE":moca.EFC_BOAD_POP._boardType,
                                 "BOAD_IDX":moca.EFC_BOAD_POP._boardIdx,
                                 "BOAD_PIDX":moca.EFC_BOAD_POP._boardIdx,
                                 "BOAD_TITLE":moca.getValue(moca.EFC_BOAD_POP.getObj("wtitle")),
                                 "BOAD_CONT":CKEDITOR.instances.editor.getData(),
                                 "BOAD_WRITER":moca.getSs("USER_ID"),
                                 "fileList":moca.EFC_BOAD_POP.getFilteredList("grd_file","status","C")
                                 }
                         },          
                         callback : function(response){
                             if(response.cnt > 0){
                                 moca.alert('성공적으로 저장하였습니다.');
                                 moca.popClose(moca.EFC_BOAD_POP.pageId);
                                 if(moca.EFC_BOAD_POP._boardType == 'ERP'){
 	                            	moca.EFC_BOAD.fn_search();
 	                             }else{
 	                            	moca.EFC_BOAD_WS.fn_search();
 	                             }
                             }
                         }
                     });
	            }
	        }
	    });
	}else{
		//답변저장
		moca.confirm('답변을 저장하시겠습니까?',function(result){
	        if(result == 'Y'){
	        	
	            var _ReplyIdx = moca.getValue(moca.EFC_BOAD_POP.getObj("wreplyidx"));
	            for(var i=0; i<grd_reply_file.list.length;i++){
	            	if(grd_reply_file.list[i]._system.status != "D"){
	            		grd_reply_file.list[i]._system.status = "C";
	            	}
	            };
	            if(_ReplyIdx == null || _ReplyIdx == ""){
	    			//답변등록
	        		moca.EFC_BOAD_POP.exe({
	                    url : moca._domain+moca._contextRoot+"/EFC_BOAD/insertBoard.do",
	                    loadingbar:true,
	                    data : {
	                        "header" : moca.header,
	                        "body" : {
	                        	"BOAD_DELYN":'N',
	                        	"BOAD_TYPE":moca.EFC_BOAD_POP._boardType,
	                        	"BOAD_PIDX":moca.EFC_BOAD_POP._boardIdx,
	                            "BOAD_TITLE":moca.getValue(moca.EFC_BOAD_POP.getObj("wreplytitle")),
	                            "BOAD_CONT":CKEDITOR.instances.reply_editor.getData(),
	                            "BOAD_WRITER":moca.getValue(moca.EFC_BOAD_POP.getObj("wreplyid")),
	                            "fileList":moca.EFC_BOAD_POP.getFilteredList("grd_reply_file","status","C")
	                            }
	                    },          
	                    callback : function(response){
	                        if(response.cnt > 0){
	                            moca.alert('성공적으로 저장하였습니다.');
	                            moca.popClose(moca.EFC_BOAD_POP.pageId);
	                            if(moca.EFC_BOAD_POP._boardType == 'ERP'){
	                            	moca.EFC_BOAD.fn_search();
	                            }else{
	                            	moca.EFC_BOAD_WS.fn_search();
	                            }
	                        }
	                    }
	                });
	        	}else{
	        		//답변수정
	        		 moca.EFC_BOAD_POP.exe({
	                     url : moca._domain+moca._contextRoot+"/EFC_BOAD/updateBoard.do",
	                     loadingbar:true,
	                     data : {
	                         "header" : moca.header,
	                         "body" : {
	                        	 "BOAD_TYPE":moca.EFC_BOAD_POP._boardType,
	                        	 "BOAD_PIDX":moca.EFC_BOAD_POP._boardPIdx,
	                         	 "BOAD_IDX":moca.EFC_BOAD_POP._boardIdx,
	                             "BOAD_TITLE":moca.getValue(moca.EFC_BOAD_POP.getObj("wreplytitle")),
	                             "BOAD_CONT":CKEDITOR.instances.reply_editor.getData(),
	                             "BOAD_WRITER":moca.getSs("USER_ID"),
	                             "fileList":moca.EFC_BOAD_POP.getFilteredList("grd_reply_file","status","C")
	                             }
	                     },          
	                     callback : function(response){
	                         if(response.cnt > 0){
	                             moca.alert('성공적으로 저장하였습니다.');
	                             moca.popClose(moca.EFC_BOAD_POP.pageId);
	                             if(moca.EFC_BOAD_POP._boardType == 'ERP'){
                            		moca.EFC_BOAD.fn_search();
	                             }else{
	                             	moca.EFC_BOAD_WS.fn_search();
	                             }
	                         }
	                     }
	                 });
	        	}
	        }
	    });
		
	}
    
};
moca.EFC_BOAD_POP.fn_adminDel = function(_thisObj){
	['게시글물리삭제 관리자삭제']
	if(_thisObj.id == 'btn_del_admin'){
		_msg = '삭제하시면 데이터를 더이상 복구하실 수 없습니다.<br/>또한 원글을 삭제하실경우 답글까지도 삭제됩니다.<br/>그래도 삭제하시겠습니까?';
	}else{
		_msg = '삭제하시면 데이터를 더이상 복구하실 수 없습니다.<br/>그래도 삭제하시겠습니까?';
	}
	moca.confirm(_msg,function(result){
        if(result == 'Y'){
            //삭제
            moca.EFC_BOAD_POP.exe({
                url : moca._domain+moca._contextRoot+"/EFC_BOAD/deleteBoard.do",
                loadingbar:true,
                data : {
                    "header" : moca.header,
                    "body" : {
                        "BOAD_IDX":moca.EFC_BOAD_POP._boardIdx
                        }
                },          
                callback : function(response){
                    if(response.cnt > 0){
                        moca.alert('삭제가 완료되었습니다.');
                        moca.popClose(moca.EFC_BOAD_POP.pageId);
                        if(moca.EFC_BOAD_POP._boardType == 'ERP'){
                        	moca.EFC_BOAD.fn_search();
                        }else{
                        	moca.EFC_BOAD_WS.fn_search();
                        }
                    }
                }
            });
        }
    });
};
moca.EFC_BOAD_POP.fn_del = function(_thisObj){
	['게시글논리삭제 delYN :Y']
	 moca.confirm('삭제하시겠습니까?',function(result){
        if(result == 'Y'){
        	//게시글삭제
         	moca.EFC_BOAD_POP.exe({
                 url : moca._domain+moca._contextRoot+"/EFC_BOAD/deleteStatusBoard.do",
                 loadingbar:true,
                 data : {
                     "header" : moca.header,
                     "body" : {
                         "BOAD_IDX":moca.EFC_BOAD_POP._boardIdx,
                         }
                 },          
                 callback : function(response){
                     if(response.cnt > 0){
                     	moca.alert('삭제가 완료되었습니다.');
                         moca.popClose(moca.EFC_BOAD_POP.pageId);
                         if(moca.EFC_BOAD_POP._boardType == 'ERP'){
                         	moca.EFC_BOAD.fn_search();
                          }else{
                         	moca.EFC_BOAD_WS.fn_search();
                          }
                     }
                 }
             });
        }
	 });
};
moca.EFC_BOAD_POP.fn_searchfile = function(_grd,_idx,tdObj,_thisObj){
    if(moca.EFC_BOAD_POP._boardIdx != null){
        moca.EFC_BOAD_POP.exe({
            url : moca._domain+moca._contextRoot+"/EFC_BOAD/selectBoardFileList.do",
            loadingbar:false,
            data : {
                "header" : moca.header,
                "body" : {
                    "BOAD_IDX":moca.EFC_BOAD_POP._boardIdx
                    }
            },          
            callback : function(response){
            	moca.EFC_BOAD_POP.drawGrid('grd_file',moca.getResList(response,"selectBoardFileList"));
            }
        });
    }
};
moca.EFC_BOAD_POP._openFileUpload = function(_thisObj) {
    moca.popup({
        type:"POPUP",
        modal:"false",
        url:'/moca/comp/COMP_UPLD.html',
        title:"파일업로드",
        callback:function(result){
            //업로드완료후 리턴업로드된파일정보를 받아서
            //이후 파일관련테이블에 insert하는 로직을 추가한다.
            var fileSize = result.fileSize;
            var fileLength = result.fileLength;
            var originalFilename = result.originalFilename;
            var physicalFilename = result.physicalFilename;
            var physicalFilepath = result.physicalFilepath;
            var subDir = result.subDir;
            var uploadDir = result.uploadDir;
            if(_thisObj.id == "btn_add"){
            	 var arr = grd_file.list;
            }else{
            	 var arr = grd_reply_file.list;
            }
            var row = {BOADFILE_NAME:originalFilename,BOADFILE_SIZE:fileSize,BOADFILE_NAMESERVER:physicalFilename,BOADFILE_PATH:physicalFilepath}; 
            row._system = {"status":""};
            var sn = arr.length;
            arr[sn] =  row;
            if(_thisObj.id == "btn_add"){
            	moca.EFC_BOAD_POP.drawGrid('grd_file',arr);
            }else{
            	moca.EFC_BOAD_POP.drawGrid('grd_reply_file',arr);
            }
            
            //grd_file.list[sn]._system.status = "C";
        },
        data:{
            subDir:"EFC_BOAD_POP",
            onFileSelected:"moca.EFC_BOAD_POP.onFileSelected"
        }
    });
};

moca.EFC_BOAD_POP.grd_fileDownload = function(_grd,rowIndex,colIndex,colId){
	if(_grd.id != 'grd_reply_file'){
		var _list = moca.EFC_BOAD_POP.getObj('grd_file').list;
	}else{
		var _list = moca.EFC_BOAD_POP.getObj('grd_reply_file').list;
	}
    moca.fileDownloadAjax({
        url:moca._contextRoot+"/moca/fileDownload.do",
        param:{originalFilename:_list[rowIndex]["BOADFILE_NAME"],physicalFilename:_list[rowIndex]["BOADFILE_NAMESERVER"],subDir:moca.EFC_BOAD_POP.srcId}
    });
};
moca.EFC_BOAD_POP.onFileSelected = function(filename,filesize,_e,_this) {
    //filename이나 filesize를 활용하여 업로드여부를 체크할수있다.
    
    return true;//or false
};
moca.EFC_BOAD_POP.popId = "EFC_BOAD_ANS_POP";
moca.EFC_BOAD_POP.fn_reply = function(_thisObj){
    ['답변달기']
    $(moca.EFC_BOAD_POP.getObj("cke_editor")).find('#cke_1_top').hide();
    moca.setReadOnly(moca.EFC_BOAD_POP.getObj("wreplytitle"),false);
    $(moca.EFC_BOAD_POP.getObj("reply_area")).show();
    moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply"));
    moca.hide(moca.EFC_BOAD_POP.getObj("btn_update"));
    moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_update"));
    moca.hide(moca.EFC_BOAD_POP.getObj("btn_del"));
    moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_del"));
    moca.hide(moca.EFC_BOAD_POP.getObj("btn_del_admin"));
    moca.hide(moca.EFC_BOAD_POP.getObj("btn_reply_del_admin"));
    
    moca.setValue(moca.EFC_BOAD_POP.getObj("wreplyid"),moca.getSs("USER_ID"));
};

moca.EFC_BOAD_POP.fn_reply_search = function(_grd,_idx,tdObj,_thisObj){
	moca.EFC_BOAD_POP.exe({
		url : moca._domain+moca._contextRoot+"/EFC_BOAD/selectBoardInfo.do",
		loadingbar:true,
		data : {
			"header" : moca.header,
			"body" : {
				"BOAD_IDX":moca.EFC_BOAD_POP._boardIdx
				}
		},			
		callback : function(response){
				if(response.selectBoardInfo != null ){
				var data = response.selectBoardInfo;
				CKEDITOR.instances.reply_editor.setData(data.BOAD_CONT);
				moca.setValue(moca.EFC_BOAD_POP.getObj("wreplytitle"),data.BOAD_TITLE);
				moca.setValue(moca.EFC_BOAD_POP.getObj("wreplydate"),data.BOAD_DATE);
				moca.setValue(moca.EFC_BOAD_POP.getObj("wreplyid"),data.BOAD_WRITER);
			    moca.setValue(moca.EFC_BOAD_POP.getObj("wreplyidx"),data.BOAD_IDX);
			    moca.hide(moca.EFC_BOAD_POP.getObj("btn_save"));
			    moca.hide(moca.EFC_BOAD_POP.getObj("btn_add"));
			    if(moca.getValue(moca.EFC_BOAD_POP.getObj("wid")) != moca.getSs("USER_ID") && moca.getSs("authorCode") != "ROLE_SUPER_ADMIN"){
			    	moca.hide(moca.EFC_BOAD_POP.getObj("btn_update"));
			    	moca.hide(moca.EFC_BOAD_POP.getObj("btn_del"));
			    }
			    //moca.EFC_BOAD_POP.fn_searchfile();
			    moca.EFC_BOAD_POP.drawGrid('grd_reply_file',moca.getResList(response,"selectBoardFileList"));
			    
			}else{
				moca.error(response.error);
			}
		}
	});
};

</script>
<style>
</style>
</head>
<body>
	<div class="moca_pop_cont_wrap" style="display:none" id="contents">
        <div class="lybox sc_row flex">
            <div class="ly_column col_5">
                <div class="ly_col_cont flex_column">
			         <div type="form" id="form_3" class="moca_table toolbar" style=""
			                label="게시물작성"
			                showRowSelection="false"
			                addition='[
			                {"type":"button","position":"right","id":"btn_reply","label":"답변작성","onclick":"moca.EFC_BOAD_POP.fn_reply","addClass":""},
			                {"type":"button","position":"right","id":"btn_update","label":"수정","onclick":"moca.EFC_BOAD_POP.fn_update","addClass":""},
			                {"type":"button","position":"right","id":"btn_del","label":"삭제","onclick":"moca.EFC_BOAD_POP.fn_del","addClass":""},
			                {"type":"button","position":"right","id":"btn_save","label":"저장","onclick":"moca.EFC_BOAD_POP.fn_save","addClass":""},
			                {"type":"button","position":"right","id":"btn_del_admin","label":"관리자삭제","onclick":"moca.EFC_BOAD_POP.fn_adminDel","innerStyle":"background:#ff3333", "addClass":""}
			                    ]'
			                >
			                    <table class="moca_table_cont" style="">
			                        <colgroup>
			                                <col style="width:80px">
			                                <col style="">
			                                <col style="width:200px">
			                                <col style="width:120px">
			                        </colgroup>
			                        <thead>
			                            <tr>
			                                <th>ID</th>
			                                <th>제목</th>
			                                <th>작성일시</th>
			                                <th>작성자</th>
			                            </tr>
			                        </thead>
			                        <tbody>
			                            <tr>
			                                <td>
			                                    <div type="input" id="widx" class="mocaInput" innerClass="tac" onclick="" style="" value="" readonly="true"></div>
			                                </td>
			                                <td>
			                                    <div type="input" class="mocaInput req" style="width:100%;" innerStyle="" id="wtitle" displayFormat=""  readonly="true"
			                                        defaultValue="" 
			                                        selecterItem=""
			                                        showRadioOption="false"
			                                    ></div>
			                                </td>
			                                <td>
			                                    <div type="input" class="mocaInput" style="width:100%;text-align:center;" innerStyle="text-align:center;" id="wdate" displayFunction="moca.dateFormat"  readonly="true"
			                                        defaultValue="" 
			                                        selecterItem=""
			                                        showRadioOption="false"
			                                    ></div>
			                                </td>
			                                <td>
			                                    <div type="input" class="mocaInput" style="width:100%;text-align:center;" innerStyle="text-align:center;" id="wid" displayFormat=""  readonly="true"
			                                        defaultValue="" 
			                                        selecterItem=""
			                                        showRadioOption="false"
			                                    ></div>
			                                </td>
			                            </tr>  
			                        </tbody>
			                    </table>
			                    
			        </div>
			        <div type="grid" class="moca_grid toolbar sc_row1 mt10 fold" default_cell_height="26px" id="grd_file" style="top:0; height:141px" rowSelectedColor="#434e5f"
			        
			                            toolbar_search_size="false"
			                            toolbar_detail="false"
			                            toolbar_exup="false"
			                            toolbar_exdn="false"
			                            toolbar_addrow="false"
			                            toolbar_delrow="true"
			                            toolbar_nextbtn="false"
			                            toolbar_full="false"
			                            toolbar_fold="true"
			                            toolbar_grid_button2='{"position":"right","id":"btn_add","label":"파일추가","onclick":"moca.EFC_BOAD_POP._openFileUpload","addClass":"","innerDisabled":"false"}'
			                            onDblClick = "moca.EFC_BOAD_POP.grd_fileDownload"
			                            label="첨부파일"
			        
			        >
			                <table style="width: 100%">
			                    <colgroup>
			                            <col style="width:60px">
			                            <col style="width:80px">
			                            <col style="">
			                            <col style="width:150px">       
			                    </colgroup>
			                    <thead>
			                        <tr>
			                            <th scope="col" id="H_status">상태</th>
			                            <th scope="col" id="H_BOADFILE_IDX">파일ID</th>
			                            <th scope="col" id="H_BOADFILE_NAME">파일명</th>
			                            <th scope="col" id="H_BOADFILE_SIZE">파일크기</th>
			                        </tr>
			                    </thead>
			                    <tbody>
			                        <tr>
			                            <td id="status" celltype="input" style="" readOnly="true" name="상태"></td>
			                            <td id="BOADFILE_IDX" celltype="input" style="" readOnly="true" name="파일ID"></td>
			                            <td id="BOADFILE_NAME" celltype="input" style="text-align:left" name="파일명" readOnly="true"></td>
			                            <td id="BOADFILE_SIZE" celltype="input" style="" name="파일크기" readOnly="true"></td>
			                        </tr>
			                    </tbody>
			                </table>                
			        </div>
			        <div class="mt10 edit fit"  style="top:0">
			            <div contenteditable="true" placeholder="" id="editor"></div>
			        </div>
                </div>
            </div>
            <div class="ly_column col_5" id="reply_area" style="display:none;">
                <div class="ly_col_cont pl15 flex_column">
                     <div type="form" id="form_reply" class="moca_table toolbar" style=""
                            label="게시물답변"
                            showRowSelection="false"
                            addition='[
                            {"type":"button","position":"right","id":"btn_reply_update","label":"답변수정","onclick":"moca.EFC_BOAD_POP.fn_update","addClass":""},
			                {"type":"button","position":"right","id":"btn_reply_del","label":"답변삭제","onclick":"moca.EFC_BOAD_POP.fn_del","addClass":""},
                            {"type":"button","position":"right","id":"btn_reply_save","label":"답변저장","onclick":"moca.EFC_BOAD_POP.fn_save","addClass":""},
                            {"type":"button","position":"right","id":"btn_reply_del_admin","label":"관리자삭제","onclick":"moca.EFC_BOAD_POP.fn_adminDel","innerStyle":"background:#ff3333", "addClass":""}
                                ]'
                            >
                                <table class="moca_table_cont" style="">
                                    <colgroup>
                                            <col style="width:80px">
                                            <col style="">
                                            <col style="width:200px">
                                            <col style="width:120px">
                                    </colgroup>
                                    <thead>
                                        <tr>
                                            <th class="bg_green">답변ID</th>
                                            <th class="bg_green">제목</th>
                                            <th class="bg_green">작성일시</th>
                                            <th class="bg_green">작성자</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div type="input" id="wreplyidx" class="mocaInput" innerClass="tac" onclick="" style="" value="" readonly="true"></div>
                                            </td>
                                            <td>
                                                <div type="input" class="mocaInput req" style="width:100%;" innerStyle="" id="wreplytitle" displayFormat=""  readonly="true"
                                                    defaultValue="" 
                                                    selecterItem=""
                                                    showRadioOption="false"
                                                ></div>
                                            </td>
                                            <td>
                                                <div type="input" class="mocaInput" style="width:100%; text-align:center;" innerStyle="text-align:center;" id="wreplydate" displayFunction="moca.dateFormat"  readonly="true"
                                                    defaultValue="" 
                                                    selecterItem=""
                                                    showRadioOption="false"
                                                ></div>
                                            </td>
                                            <td>
                                                <div type="input" class="mocaInput" style="width:100%; text-align:center;" innerStyle="text-align:center;" id="wreplyid" displayFormat=""  readonly="true"
                                                    defaultValue="" 
                                                    selecterItem=""
                                                    showRadioOption="false"
                                                ></div>
                                            </td>
                                        </tr>  
                                    </tbody>
                                </table>
                                
                    </div>
                    <div type="grid" class="moca_grid toolbar sc_row mt10 fold" default_cell_height="26px" id="grd_reply_file" style="top:0; height:141px" rowSelectedColor="#434e5f"
                    
                                        toolbar_search_size="false"
                                        toolbar_detail="false"
                                        toolbar_exup="false"
                                        toolbar_exdn="false"
                                        toolbar_addrow="false"
                                        toolbar_delrow="true"
                                        toolbar_nextbtn="false"
                                        toolbar_full="false"
                                        toolbar_fold="true"
                                        toolbar_grid_button2='{"position":"right","id":"btn_reply_add","label":"업로드","onclick":"moca.EFC_BOAD_POP._openFileUpload","addClass":"","innerDisabled":"false"}'
                                        onDblClick = "moca.EFC_BOAD_POP.grd_fileDownload"
                                        label="답변 첨부파일"
                    
                    >
                            <table style="width: 100%">
                                <colgroup>
                                        <col style="width:60px">
                                        <col style="width:80px">
                                        <col style="">
                                        <col style="width:150px">       
                                </colgroup>
                                <thead>
                                    <tr>
                                        <th scope="col" class="bg_green" id="H_status">상태</th>
                                        <th scope="col" class="bg_green" id="H_BOADFILE_IDX">파일ID</th>
                                        <th scope="col" class="bg_green" id="H_BOADFILE_NAME">파일명</th>
                                        <th scope="col" class="bg_green" id="H_BOADFILE_SIZE">파일크기</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td id="status" celltype="input" style="" readOnly="true" name="상태"></td>
                                        <td id="BOADFILE_IDX" celltype="input" style="" readOnly="true" name="파일ID"></td>
                                        <td id="BOADFILE_NAME" celltype="input" style="text-align:left" name="파일명" readOnly="true"></td>
                                        <td id="BOADFILE_SIZE" celltype="input" style="" name="파일크기" readOnly="true"></td>
                                    </tr>
                                </tbody>
                            </table>                
                    </div>
                    <div class="mt10 edit fit"  style="top:0">
                        <div contenteditable="true" placeholder="" id="reply_editor"></div>
                    </div>
                </div>
            </div>
        </div>
	</div>
</body>
</html>