<!DOCTYPE html>
<html lang="ko">
<head>
<script>
	
	$m.MT_GRID.___ready = function(){
		$m.MT_GRID.code({
			"grd_comp.EFC_COMBO":{code:'TEST'},
			"cmb_1":{code:'boardStatus'},
			"scmb_1":{code:'boardStatus'}
		},function(){
			$m.MT_GRID.exe({
				url : $m._domain+$m._contextRoot+"/efms/EFC_CORP/list_json.do",
				loadingbar:true,
	            data : {
	            	"header" : $m.header,
	            	"body" : {aaa:'111',bbb:'222'}
	            },			
				callback : function(response){
					var g_obj = $m.MT_GRID.getObj('grd_comp');
					if(g_obj['CORP_CD'] == undefined){
						g_obj['CORP_CD'] = {};
						g_obj['CORP_CD']['codeOpt'] = {allOption:{label:'-선택-',value:''},metaInfo:{codeCd:"CORP_CD",codeNm:"CORP_NM"}};
					} 
					g_obj['CORP_CD']['list'] = response.list;
					
					$m.MT_GRID.fn_search();
				}
			});
		});
	};
	
	$m.MT_GRID.fn_search = function(){
		$m.MT_GRID.exe({
			url : $m._domain+$m._contextRoot+"/MT_TEST/selectTestList.do",
            data : {
            	"header" : $m.header,
            	"body" : {
            		"TEST_TYPE":"GRID"
            	}
            },			
			callback : function(response){
				$m.MT_GRID.drawGrid('grd_2', $m.MT_GRID.getResList(response,"selectTestList"));
				$m.MT_GRID.fn_comp();
				if($m.getDevice() == 'mobile'){
					$($m.MT_GRID.getObj('grd_comp')).find('.grid_label_span').hide();
					$($m.MT_GRID.getObj('grd_comp')).find('.moca_radio').hide();
				}
			}
		});
	};
	$m.MT_GRID.fn_comp = function(){
		$m.MT_GRID.exe({
			url : $m._domain+$m._contextRoot+"/MT_TEST/selectTestList.do",
            data : {
            	"header" : $m.header,
            	"body" : {
            		"TEST_TYPE":"TEST2"
            	}
            },			
			callback : function(response){
				$m.MT_GRID.drawGrid('grd_comp', $m.MT_GRID.getResList(response,"selectTestList"));
				$m.MT_GRID.fn_search_grd13();
			}
		});
	};
	$m.MT_GRID.fn_exe = function(){
		if($m.EFC_PROP.validate("grd_1","status","C,U,D")){
			$m.confirm('저장하시겠습니까?',function(result){
				if(result == 'Y'){
					$m.EFC_PROP.exe({
						url : $m._domain+$m._contextRoot+"/efms/EFGPROP/modify_json.do",
			            data : {
			            	"header" : $m.header,
			            	"body" : {
			            		paramList:$m.EFC_PROP.getFilteredList("grd_1","status","C,U,D")
			            	}
			            },		
						callback : function(){
			        	   $m.alert('성공적으로 저장되었습니다!',function(){
			        		   $m.EFC_PROP.fn_search();
			        	   	   return;
			        	   });	
						}
					});
				}
			});
		}
	};
	$m.MT_GRID.fn_search_grd13 = function(){
		$m.MT_GRID.exe({
			url : $m._domain+$m._contextRoot+"/TO_013/fincialDbList.do",
			loadingbar:true,
			data : {
				"header" : $m.header,
				"body" : {
					"inqType":"1"
				}
			},			
			callback : function(response){
				$m.MT_GRID.drawGrid('grd_13',$m.getResList(response,"fincialDbList"));
				grd_13.setAttribute("selectedRealRowIndex","0");
				$m._setRowSelection(grd_13);
				$m.setFocus($m.MT_GRID.getObj("keyWordFinacName"));
			}
		});
	} 
	$m.MT_GRID._excelCallback = function(_json){
		if(_json.gridId == "grd_13"){
			$m.MT_GRID.fn_search_grd13();
		}
	};
	$m.MT_GRID.grd_01__onDblClick = function(_grd,rowIndex,colIndex,colId){
	}
	$m.MT_GRID._openFileUpload = function(_thisObj) {
		 var o = {};
		 	o.url = '/moca/comp/COMP_UPLD.html';
		 	//o.id = "COMP_UPLD";
		    o.type = "POPUP";
		    o.modal = "false";
		    o.title = '파일업로드';
		    o.callback = function(result){
		    	if(result != null){
		    		//업로드완료후 리턴업로드된파일정보를 받아서
		            //이후 파일관련테이블에 insert하는 로직을 추가한다.
		            var fileSize = result.fileSize;
		            var fileLength = result.fileLength;
		            var originalFilename = result.originalFilename;
		            var physicalFilename = result.physicalFilename;
		            var physicalFilepath = result.physicalFilepath;
		            var subDir = result.subDir;
		            var uploadDir = result.uploadDir;
		            var arr = $m.MT_GRID.getObj("grd_file").list;
		            var row = {BOARDFILE_NAME:originalFilename,BOARDFILE_SIZE:fileSize,BOARDFILE_NAMESERVER:physicalFilename,BOARDFILE_PATH:physicalFilepath}; 
		            row._system = {"status":""};
		            var sn = arr.length;
		            arr[sn] =  row;
		            $m.MT_GRID.drawGrid('grd_file',arr);
		            //grd_file.list[sn]._system.status = "C";
		    	}
	        },
		    o.scopeId = $m.MT_GRID.pageId;
		    o.data = {
		    		subDir:"MT_GRID",
		            onFileSelected:"$m.MT_GRID.onFileSelected"
		    };
		    $m.popup(o,_thisObj);
	};
	$m.MT_GRID.onFileSelected = function(filename,filesize,_e,_this) {
	    //filename이나 filesize를 활용하여 업로드여부를 체크할수있다.
	    
	    return true;//or false
	};
</script>

</head>
<body>
	
<div id="moca_tab_bridge1" class="moca_tab_panel" role="mdipanel" style="display:block;visibility:visible;">
	<div class="moca_tab_cont" style="height:100%">
		<div class="moca_cont_wrap flex fcol">
			<div type="include" class="moca_titbox cm noshbox" id="titbox" tag="moca:titbox" 
				src="/html/titlebox.html"
				data = '{"sreenCd":"MT_GRID","sreenNm":"시스템설정","sreenPath":"시스템관리,시스템설정"}'
			></div>
			<div type="grid" class="moca_grid toolbar sc_row1 mt10" default_cell_height="26px" id="grd_comp" style=" top:0; height:112px" rowSelectedColor="#434e5f"
	        		rendering_div = "true"
					toolbar_search_size="false"
					toolbar_common_btns_pc='{"detail":"true","exup":"false","exdn":"true","addrow":"false","delrow":"false","full":"true"}'
					toolbar_common_btns_mobile='{"detail":"false","exup":"false","exdn":"false","addrow":"false","delrow":"false","full":"true"}'
					toolbar_detail="true"
					toolbar_exup="false"
					toolbar_exdn="false"
					toolbar_addrow="true"
					toolbar_delrow="true"
					toolbar_full="true"
					toolbar_grid_button1='{"position":"right","id":"btn_add","label":"저장","onclick":"$m.MT_GRID.fn_exe","addClass":"","innerDisabled":"false"}'
					toolbar_grid_label_span='{"position":"left","id":"todayCnt","label":"labelSpan","value":"200,000","valueClass":"txt_green","unit":"원"}'
					toolbar_grid_label_input='{"position":"left","id":"totalPeople","label":"labelInput","value":"","width":"65px"}'
					toolbar_grid_label_combo='{"position":"left","id":"totalCombo","label":"labelCombo","value":"","width":"65px"}'
					toolbar_grid_label_ ='{"position":"left","id":"totalradio","label":"radio"}'
					toolbar_grid_radio='{"position":"left","id":"radio1","label":"radio1","onclick":"$m.MT_GRID.blank","value":[{"label":"Y","value":"1","checked":"1"},{"label":"N","value":"0"}],"width":"100px"}'
					onDblClick = "$m.MT_GRID.grd_01__onDblClick"
					label ="시연 GridCellType"
		        >
	                <table style="width: 100%">
						<colgroup>
								<col style="width:60px" mobileHide="false" hide="false" columnKey="TEST_YN" thKey="H_TEST_YN" >
								<col style="width:120px" mobileHide="false" hide="false" columnKey="TEST_YN2" thKey="H_TEST_YN2" >
								<col style="width:120px" mobileHide="false" hide="false" columnKey="EFC_COMBO" thKey="H_EFC_COMBO" >
								<col style="width:300px" mobileHide="true" hide="false" columnKey="TEST_DB" thKey="H_TEST_DB" >		
								<col style="width:160px" mobileHide="true" hide="false" columnKey="TEST_VALUE" thKey="H_TEST_VALUE" >
						</colgroup>
						<thead>
							<tr>
								<th scope="col" id="H_TEST_YN">checkbox</th>
								<th scope="col" id="H_TEST_YN2">radio</th>
								<th scope="col" id="H_TEST_COMBO">combo</th>
								<th scope="col" id="H_TEST_DB">input</th>
								<th scope="col" id="H_TEST_VALUE">editorMode='true'</th>
								
							</tr>
						</thead>
						<tbody>
							<tr>
								<td id="TEST_YN" celltype="checkbox" style="" trueValue="1" falseValue="0" name="선택" disabledFunction="" ></td>
								<td id="TEST_YN2" celltype="radio" style="" name="선택" 
									  itemset='[{"label":"yes","value":"1","checked":"true"},
									              {"label":"no","value":"0"}
									              ]'
								
								></td>
								<td id="EFC_COMBO" celltype="select" style="text-align:center" required="true" name="공통콤보" readOnly="false"></td>
								<td id="TEST_DB" celltype="input" style="" name="값" readOnly="false"></td>
								<td id="TEST_VALUE" celltype="input" style="text-align:left"  name="설명 (editorMode='true')"  required="false" editorMode="true" ></td>
								
							</tr>
						</tbody>
					</table>              
	        </div>
	        <div type="grid" class="moca_grid toolbar fauto mt12"" default_cell_height="26px" id="grd_13" 
	        		toolbar_common_btns_pc='{"detail":"false","exup":"true","exdn":"true","addrow":"false","delrow":"false","full":"true"}'
					toolbar_common_btns_mobile='{"detail":"false","exup":"true","exdn":"true","addrow":"false","delrow":"false","full":"true"}'
					toolbar_search_size="false"
					toolbar_col_showhide="false"
					toolbar_detail="false"
					toolbar_exup="true"
					toolbar_exdn="true"
					toolbar_addrow="false"
					toolbar_delrow="false"
					toolbar_nextbtn="false"
					toolbar_full="true"
					
					label="시연_Grid excel">
					<table style="width: 100%">
						<colgroup>
								<col style="width:60px"><!-- 순번 -->
								<col style="width:0px"><!-- Idx -->
								<col style="width:100px"><!-- 구분 -->
								<col style="width:250px"><!-- 금융기관명 -->
								<col style="width:100px"><!-- 담당자 -->
								<col style="width:500px"><!-- 주소 -->
								<col style="width:120px"><!-- 전화번호 -->
								<col style=""><!-- 비고 -->
						</colgroup>
						<thead>
							<tr>
								<th id="H_rowNum">순번</th>
								<th id="H_idx">ID</th>
								<th id="H_a01">컬럼1</th>
								<th id="H_a02">컬럼2</th>
								<th id="H_a03">이름</th>
								<th id="H_a05">주소</th>
								<th id="H_a06">전화번호</th>
								<th id="H_a07">비고</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td excelIndex="0"  id="rowNum" name="순번" celltype="input" style="" readonly="true" displayFunction="$m.fn_display_rownum"></td>
								<td excelIndex="1"  id="idx" name="ID" celltype="input" style="" readonly="true" ></td>
								<td excelIndex="2"  id="FinacName" name="컬럼1"  celltype="input" style="text-align:left" readonly="true" displayFunction=""></td>	
								<td excelIndex="3"  id="EditFinacName" name="컬럼2"  celltype="input" style="text-align:left" readonly="true" displayFunction=""></td>
								<td excelIndex="4"  id="FinacManager" name="이름"  celltype="input" style="" readonly="true" displayFunction=""></td>
								<td excelIndex="5"  id="FinacAddress" name="주소"  celltype="input" style="text-align:left" readonly="true" displayFunction=""></td>
								<td excelIndex="6"  id="CorpPhone" name="전화번호"  celltype="input" style="" readonly="true" displayFunction=""></td>
								<td excelIndex="7"  id="Note" name="비고"  celltype="input" style="" readonly="true" displayFunction=""></td>
							</tr>
						</tbody>
					</table>				
			</div>
			<div type="grid" class="moca_grid toolbar fauto mt12 explanation" style="height:161px" default_cell_height="26px" id="grd_2" rowSelectedColor="#434e5f"
								rendering_div = "true"
								toolbar_search_size="false"
								toolbar_common_btns_pc='{"detail":"false","exup":"false","exdn":"true","addrow":"false","delrow":"false","full":"true"}'
								toolbar_common_btns_mobile='{"detail":"false","exup":"false","exdn":"false","addrow":"false","delrow":"false","full":"true"}'
								toolbar_detail="false"
								toolbar_exup="false"
								toolbar_exdn="true"
								toolbar_addrow="false"
								toolbar_delrow="false"
								toolbar_full="true"
								label="설명"
			
			>
					<table style="width: 100%">
						<colgroup>
								<col style="width:60px" mobileHide="true" hide="false" columnKey="status" thKey="H_STATUS" >
								<col style="width:150px" mobileHide="false" hide="false" columnKey="TEST_PROP" thKey="H_TEST_PROP" >
								<col style="" mobileHide="false" hide="false" columnKey="TEST_VALUE" thKey="H_TEST_VALUE" >
								<col style="width:400px" mobileHide="true" hide="false" columnKey="TEST_DB" thKey="H_TEST_DB" >		
						</colgroup>
						<thead>
							<tr>
								<th scope="col" id="H_STATUS">상태</th>
								<th scope="col" id="H_TEST_PROP">속성</th>
								<th scope="col" id="H_TEST_VALUE">값</th>
								<th scope="col" id="H_TEST_DB">설명</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td id="status" celltype="input" style="" readOnly="true" name="상태"></td>
								<td excelIndex="1" id="TEST_PROP" celltype="input" style="text-align:left" name="속성" required="false" readOnly="true" ></td>
								<td excelIndex="2" id="TEST_VALUE" celltype="input" style="text-align:left" name="값" readOnly="true"></td>
								<td excelIndex="3" id="TEST_DB" celltype="input" style="text-align:left" name="설명 " readOnly="true" required="false" editorMode="true" ></td>
							</tr>
						</tbody>
					</table>				
			</div>
			
		</div>	
	</div>
</div>
</body>
</html>